<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  body{height:100vh;background:#0a0a0a;overflow:hidden;font-family:system-ui}
  canvas{display:block;width:100%;height:100%}
  
  /* ã‚¨ãƒ•ã‚§ã‚¯ãƒˆåˆ‡æ›¿ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
  .menu{position:fixed;top:15px;left:15px;background:rgba(0,0,0,.8);padding:12px;border-radius:10px;color:#fff}
  .menu button{
    display:block;
    width:180px;
    padding:10px;
    margin:5px 0;
    background:#333;
    border:2px solid #555;
    color:#fff;
    border-radius:6px;
    cursor:pointer;
    font-size:14px;
    transition:all .2s;
  }
  .menu button:hover{background:#555;transform:scale(1.05)}
  .menu button.active{background:#667eea;border-color:#667eea}
  
  .hint{position:fixed;bottom:15px;left:15px;color:rgba(255,255,255,.5);font-size:13px}
</style>
</head>
<body>
  <canvas id="c"></canvas>
  
  <div class="menu">
    <button onclick="setEffect(0)" class="active">ğŸ’§ ã‚¤ãƒ³ã‚¯åºƒãŒã‚Š</button>
    <button onclick="setEffect(1)">âœ¨ æ˜Ÿã®çˆ†ç™º</button>
    <button onclick="setEffect(2)">ğŸŒŠ æ³¢ç´‹</button>
    <button onclick="setEffect(3)">ğŸ† èŠ±ç«</button>
    <button onclick="setEffect(4)">âš¡ ç¨²å¦»</button>
    <button onclick="setEffect(5)">â„ï¸ é›ªã®çµæ™¶</button>
    <button onclick="setEffect(6)">ğŸ”¥ ç‚</button>
    <button onclick="setEffect(7)">ğŸŒ€ æ¸¦å·»ã</button>
  </div>
  
  <div class="hint">ã‚¯ãƒªãƒƒã‚¯/ã‚¿ãƒƒãƒ—ã§ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç™ºå‹•</div>

<script>
// ============================
// åŸºæœ¬è¨­å®š
// ============================
const cvs = document.getElementById('c');
const ctx = cvs.getContext('2d');
let W, H;
let particles = [];
let currentEffect = 0;

// ç”»é¢ãƒªã‚µã‚¤ã‚ºå¯¾å¿œ
function resize(){
  W = cvs.width = window.innerWidth;
  H = cvs.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

// ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
const rand = (a, b) => a + Math.random() * (b - a);
const randInt = (a, b) => Math.floor(rand(a, b + 1));

// ============================
// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ1: ã‚¤ãƒ³ã‚¯åºƒãŒã‚Šï¼ˆã‚ªãƒªã‚¸ãƒŠãƒ«ç‰ˆï¼‰
// ============================
function inkEffect(x, y){
  // ãƒ©ãƒ³ãƒ€ãƒ ãªã‚«ãƒ©ãƒ•ãƒ«ãªè‰²
  const color = `hsl(${Math.floor(rand(0,360))} ${Math.floor(rand(60,90))}% ${Math.floor(rand(45,65))}%)`;
  
  // ä¸è¦å‰‡ã«åºƒãŒã‚‹ã‚¤ãƒ³ã‚¯ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«
  for (let i = 0; i < 22; i++){
    particles.push({
      x, y,
      vx: Math.cos(i/3.5 + rand(-0.6, 0.6)) * rand(1, 6),
      vy: Math.sin(i/2.5 + rand(-0.6, 0.6)) * rand(1, 6),
      r: rand(6, 26),
      life: rand(60, 120),
      maxLife: 120,
      color: color,
      type: 'ink'
    });
  }
  
  // ã‚¯ãƒªãƒƒã‚¯åœ°ç‚¹ã®å°ã•ãªç™½ã„æ³¢ç´‹
  particles.push({
    x, y,
    vx: 0,
    vy: 0,
    r: 2,
    life: 18,
    maxLife: 18,
    color: 'white',
    type: 'ink'
  });
}

// ============================
// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ2: æ˜Ÿã®çˆ†ç™º
// ============================
function starExplosion(x, y){
  // å…‰ã‚‹æ˜Ÿãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«
  for (let i = 0; i < 40; i++){
    const angle = rand(0, Math.PI * 2);
    const speed = rand(1, 10);
    
    particles.push({
      x, y,
      vx: Math.cos(angle) * speed,
      vy: Math.sin(angle) * speed,
      r: rand(2, 6),
      life: rand(40, 80),
      maxLife: 80,
      color: ['#ffd700', '#ffff00', '#fff'][randInt(0, 2)],
      type: 'star'
    });
  }
}

// ============================
// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ3: æ³¢ç´‹
// ============================
function ripple(x, y){
  // 3é‡ã®æ³¢ç´‹
  for (let i = 0; i < 3; i++){
    particles.push({
      x, y,
      r: 5,
      maxR: 150,
      speed: rand(2, 4),
      life: 60,
      maxLife: 60,
      color: `hsl(${randInt(180,220)} 70% 60%)`,
      delay: i * 8,
      type: 'ripple'
    });
  }
}

// ============================
// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ4: èŠ±ç«
// ============================
function firework(x, y){
  const color = `hsl(${randInt(0,360)} 80% 60%)`;
  
  // æ”¾å°„çŠ¶ã«é£›ã³æ•£ã‚‹
  for (let i = 0; i < 50; i++){
    const angle = rand(0, Math.PI * 2);
    const speed = rand(3, 12);
    
    particles.push({
      x, y,
      vx: Math.cos(angle) * speed,
      vy: Math.sin(angle) * speed - 2,
      r: rand(3, 8),
      life: rand(50, 90),
      maxLife: 90,
      color: color,
      gravity: 0.15,
      type: 'firework'
    });
  }
}

// ============================
// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ5: ç¨²å¦»
// ============================
function lightning(x, y){
  // ç¨²å¦»ã®æ
  const branches = 5;
  
  for (let b = 0; b < branches; b++){
    const points = [{x, y}];
    let curX = x;
    let curY = y;
    
    // ã‚¸ã‚°ã‚¶ã‚°ã«ä¼¸ã³ã‚‹
    for (let i = 0; i < 8; i++){
      curX += rand(-30, 30);
      curY += rand(20, 40);
      points.push({x: curX, y: curY});
    }
    
    particles.push({
      points: points,
      life: 20,
      maxLife: 20,
      width: rand(2, 5),
      type: 'lightning'
    });
  }
}

// ============================
// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ6: é›ªã®çµæ™¶
// ============================
function snowflake(x, y){
  // 6æ–¹å‘ã®çµæ™¶
  for (let i = 0; i < 6; i++){
    const angle = (Math.PI * 2 * i) / 6;
    const len = rand(20, 50);
    
    particles.push({
      x, y,
      angle: angle,
      len: len,
      life: 80,
      maxLife: 80,
      type: 'snowflake'
    });
  }
}

// ============================
// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ7: ç‚
// ============================
function flame(x, y){
  // ä¸Šæ˜‡ã™ã‚‹ç‚ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«
  for (let i = 0; i < 30; i++){
    particles.push({
      x: x + rand(-10, 10),
      y: y,
      vx: rand(-1, 1),
      vy: rand(-8, -3),
      r: rand(5, 20),
      life: rand(30, 60),
      maxLife: 60,
      color: ['#ff4500', '#ff6347', '#ffa500', '#ffff00'][randInt(0, 3)],
      type: 'flame'
    });
  }
}

// ============================
// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ8: æ¸¦å·»ã
// ============================
function spiral(x, y){
  // èºæ—‹çŠ¶ã«åºƒãŒã‚‹
  for (let i = 0; i < 60; i++){
    const angle = (i / 60) * Math.PI * 6;
    const dist = i * 2;
    
    particles.push({
      x, y,
      angle: angle,
      dist: dist,
      speed: rand(1, 3),
      r: rand(3, 8),
      life: rand(60, 100),
      maxLife: 100,
      color: `hsl(${(i * 6) % 360} 70% 60%)`,
      type: 'spiral'
    });
  }
}

// ============================
// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå®Ÿè¡Œ
// ============================
const effects = [
  inkEffect,
  starExplosion,
  ripple,
  firework,
  lightning,
  snowflake,
  flame,
  spiral
];

// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆåˆ‡æ›¿
function setEffect(index){
  currentEffect = index;
  particles = []; // ã‚¯ãƒªã‚¢
  
  // ãƒœã‚¿ãƒ³ã®activeçŠ¶æ…‹æ›´æ–°
  document.querySelectorAll('.menu button').forEach((btn, i) => {
    btn.classList.toggle('active', i === index);
  });
}

// ã‚¯ãƒªãƒƒã‚¯/ã‚¿ãƒƒãƒ—ã§ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç™ºå‹•
cvs.addEventListener('pointerdown', e => {
  const rect = cvs.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  
  effects[currentEffect](x, y);
});

// ============================
// ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«æ›´æ–°ãƒ»æç”»
// ============================
function updateParticles(){
  for (let i = particles.length - 1; i >= 0; i--){
    const p = particles[i];
    
    // é…å»¶å‡¦ç†
    if (p.delay > 0){
      p.delay--;
      continue;
    }
    
    p.life--;
    if (p.life <= 0){
      particles.splice(i, 1);
      continue;
    }
    
    // ã‚¿ã‚¤ãƒ—åˆ¥æ›´æ–°
    switch(p.type){
      case 'ink':
        // ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ã‚¤ãƒ³ã‚¯æŒ™å‹•
        p.x += p.vx;
        p.y += p.vy;
        p.vx *= 0.98;
        p.vy *= 0.98;
        p.vy += 0.08; // ã‚ãšã‹ãªé‡åŠ›æ„Ÿ
        break;
        
      case 'star':
      case 'flame':
        p.x += p.vx;
        p.y += p.vy;
        p.vx *= 0.98;
        p.vy *= 0.98;
        p.vy += 0.1; // é‡åŠ›
        break;
        
      case 'firework':
        p.x += p.vx;
        p.y += p.vy;
        p.vy += p.gravity;
        p.vx *= 0.99;
        break;
        
      case 'ripple':
        p.r += p.speed;
        break;
        
      case 'spiral':
        p.angle += 0.05;
        p.dist += p.speed;
        p.x += Math.cos(p.angle) * p.speed;
        p.y += Math.sin(p.angle) * p.speed;
        break;
    }
  }
}

function drawParticles(){
  particles.forEach(p => {
    const alpha = p.life / p.maxLife;
    
    switch(p.type){
      case 'ink':
        // ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ã‚¤ãƒ³ã‚¯æç”»ï¼ˆcolor-mixé¢¨ã®é€æ˜åº¦ï¼‰
        const inkAlpha = Math.max(0, alpha);
        ctx.globalAlpha = inkAlpha;
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, Math.max(0.5, p.r * inkAlpha), 0, Math.PI * 2);
        ctx.fill();
        break;
        
      case 'star':
      case 'flame':
      case 'firework':
        // å††
        ctx.globalAlpha = alpha;
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r * alpha, 0, Math.PI * 2);
        ctx.fill();
        break;
        
      case 'ripple':
        // å††ã®è¼ª
        ctx.strokeStyle = p.color;
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
        ctx.stroke();
        break;
        
      case 'lightning':
        // ç¨²å¦»ã®ç·š
        ctx.strokeStyle = '#fff';
        ctx.lineWidth = p.width;
        ctx.shadowBlur = 10;
        ctx.shadowColor = '#00f';
        ctx.beginPath();
        ctx.moveTo(p.points[0].x, p.points[0].y);
        p.points.forEach((pt, i) => {
          if (i > 0) ctx.lineTo(pt.x, pt.y);
        });
        ctx.stroke();
        ctx.shadowBlur = 0;
        break;
        
      case 'snowflake':
        // é›ªã®çµæ™¶ï¼ˆ6æ–¹å‘ã®ç·šï¼‰
        ctx.strokeStyle = '#fff';
        ctx.lineWidth = 2;
        const endX = p.x + Math.cos(p.angle) * p.len * alpha;
        const endY = p.y + Math.sin(p.angle) * p.len * alpha;
        ctx.beginPath();
        ctx.moveTo(p.x, p.y);
        ctx.lineTo(endX, endY);
        ctx.stroke();
        
        // æ
        const branchLen = p.len * 0.3 * alpha;
        ctx.beginPath();
        ctx.moveTo(endX, endY);
        ctx.lineTo(
          endX + Math.cos(p.angle + Math.PI/4) * branchLen,
          endY + Math.sin(p.angle + Math.PI/4) * branchLen
        );
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(endX, endY);
        ctx.lineTo(
          endX + Math.cos(p.angle - Math.PI/4) * branchLen,
          endY + Math.sin(p.angle - Math.PI/4) * branchLen
        );
        ctx.stroke();
        break;
        
      case 'spiral':
        // æ¸¦ã®ç‚¹
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r * alpha, 0, Math.PI * 2);
        ctx.fill();
        break;
    }
  });
  
  ctx.globalAlpha = 1;
}

// ============================
// ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—
// ============================
function loop(){
  // èƒŒæ™¯ã‚’è–„ãå¡—ã£ã¦æ®‹åƒåŠ¹æœ
  ctx.fillStyle = 'rgba(10, 10, 10, 0.15)';
  ctx.fillRect(0, 0, W, H);
  
  updateParticles();
  drawParticles();
  
  requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>